<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jstl/core">
	<ui:include src="controlpropertyedit.xhtml" />
	<a4j:form>
		<rich:panel id="newDataStructurePanel"
			style="overflow:auto;height:650px">
			<h:panelGrid columns="3">
				<h:outputLabel value="Structure Name:" styleClass="name" />
				<h:inputText id="structureName"
					value="#{dataStructureAction.modelDescription.name}"
					styleClass="value" required="true"
					requiredMessage="The structure name is required." />
				<rich:message for="structureName" showDetail="false"
					showSummary="true">
					<f:facet name="errorMarker">
						<h:graphicImage url="img/error.gif" />
					</f:facet>
				</rich:message>
			</h:panelGrid>
			<h:panelGrid columns="1">
				<rich:dataTable id="newDataStructureTable"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					cellpadding="0" cellspacing="0" width="700" border="0" align="left"
					var="property"
					value="#{dataStructureAction.modelDescription.propertyDescriptionList}">
					<f:facet name="header">
						<rich:columnGroup>
							<rich:column>
								<h:outputText value="Property Name" />
							</rich:column>
							<rich:column>
								<h:outputText value="Control Type" />
							</rich:column>
							<rich:column>
								<h:outputText value="Property Type" />
							</rich:column>
							<rich:column>
								<h:outputText value="Delete" />
							</rich:column>
						</rich:columnGroup>
					</f:facet>
					<rich:column>
						<h:inputText id="propertyName" value="#{property.name}"
							readonly="#{property.name eq 'name'}" required="true"
							requiredMessage="The property name is required">
							<a4j:support event="onblur" ajaxSingle="true" />
						</h:inputText>
						<rich:message for="propertyName" showDetail="false"
							showSummary="true">
							<f:facet name="errorMarker">
								<h:graphicImage url="img/error.gif" />
							</f:facet>
						</rich:message>
					</rich:column>
					<rich:column>
						<a4j:region>
							<h:panelGrid columns="3">
								<rich:comboBox id="propertyControl" value="#{property.control}"
									converter="controlConverter" defaultLabel="Enter some value"
									suggestionValues="#{dataStructureAction.dataStructureService.controlList}"
									disabled="#{property.name eq 'name'}" enableManualInput="false">
									<a4j:support event="onselect"
										reRender="propertyType,propertyControlProperties" />
								</rich:comboBox>
								<a4j:outputPanel id="propertyControlProperties">
									<a4j:commandButton value="Properties"
										action="#{dataStructureAction.editControlProperties(property.control)}"
										rendered="#{dataStructureAction.isMutilValueControl(property.control)}"
										reRender="controlPropertyEditForm">
										<rich:componentControl for="controlPropertyEditModelPanel"
											operation="show" event="onclick" />
									</a4j:commandButton>
								</a4j:outputPanel>
								<rich:message for="propertyType" showDetail="false"
									showSummary="true">
									<f:facet name="errorMarker">
										<h:graphicImage url="img/error.gif" />
									</f:facet>
								</rich:message>
							</h:panelGrid>
						</a4j:region>
					</rich:column>
					<rich:column>
						<h:panelGrid columns="3">
							<rich:comboBox id="propertyType" value="#{property.type}"
								converter="typeConverter" defaultLabel="Enter some value"
								suggestionValues="#{dataStructureAction.dataStructureService.getTypeList(property.control)}"
								disabled="#{property.name eq 'name'}" enableManualInput="false">
								<a4j:support event="onselect" ajaxSingle="true" />
							</rich:comboBox>
							<rich:message for="propertyType" showDetail="false"
								showSummary="true">
								<f:facet name="errorMarker">
									<h:graphicImage url="img/error.gif" />
								</f:facet>
							</rich:message>
						</h:panelGrid>
					</rich:column>
					<rich:column>
						<a4j:commandButton value="Delete"
							action="#{dataStructureAction.modelDescription.propertyDescriptionList.remove(property)}"
							reRender="newDataStructureTable" ajaxSingle="true"/>
					</rich:column>
				</rich:dataTable>
			</h:panelGrid>
			<h:panelGrid columns="2">
				<a4j:commandButton ajaxSingle="true"
					action="#{dataStructureAction.addNewProperty}"
					value="Add New Property" reRender="newDataStructureTable" />
				<a4j:commandButton ajaxSingle="true"
					action="#{dataStructureAction.save}" value="Save"
					reRender="leftPanel,workspace" process="structureName" />
				<a4j:commandButton action="#{dataStructureAction.cancel}"
					value="Cancel" reRender="workspace" ajaxSingle="true" />
			</h:panelGrid>


		</rich:panel>
	</a4j:form>
</ui:composition>