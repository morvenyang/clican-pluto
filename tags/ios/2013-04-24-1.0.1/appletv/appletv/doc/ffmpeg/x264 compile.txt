CC=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc ./configure --host=arm-apple-darwin --cross-prefix=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/ --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk --prefix='dist/armv7' --extra-cflags='-arch armv7' --extra-ldflags=-L/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/usr/lib/system/ --extra-ldflags='-arch armv7' --enable-pic --enable-static --enable-shared
CC=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc ./configure --host=arm-apple-darwin --cross-prefix=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/ --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk --prefix='dist/armv7s' --extra-cflags='-arch armv7s' --extra-ldflags=-L/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/usr/lib/system/ --extra-ldflags='-arch armv7s' --enable-pic --enable-static --enable-shared
CC=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc ./configure --host=i386-apple-darwin --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.1.sdk --disable-asm --prefix=dist/i386  --extra-cflags='-arch i386' --extra-ldflags='-arch i386 -L/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator6.1.sdk/usr/lib/system' --enable-pic --enable-static --enable-shared

mkdir -p ./dist/fat/lib

xcrun -sdk iphoneos lipo -output ./dist/fat/lib/libx264.a  -create  -arch armv7s ./dist/armv7s/lib/libx264.a  -arch armv7 ./dist/armv7/lib/libx264.a -arch i386 ./dist/i386/lib/libx264.a

#cygwin
#refer to http://xidige.com/other/250
CC=/usr/bin/i686-pc-mingw32-gcc ./configure --enable-static --enable-shared --enable-win32thread  --prefix=dist --cross-prefix=/usr/bin/i686-pc-mingw32- --host=i686-pc-mingw32 --disable-asm
make 